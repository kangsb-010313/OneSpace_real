<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="perforinfo">

  <!-- infoWrite 테이블 매핑 -->
  <resultMap id="PerforInfoMap" type="com.javaex.vo.PerforInfoVO">
    <id     column="infoPostNo"      property="infoPostNo"/>
    <result column="userNo"          property="userNo"          jdbcType="BIGINT"/>
    <result column="infoPostTitle"   property="infoPostTitle"   jdbcType="VARCHAR"/>
    <result column="agencyName"      property="agencyName"      jdbcType="VARCHAR"/>
    <result column="infoContent"     property="infoContent"     jdbcType="LONGVARCHAR"/>
    <result column="infoOutUrl"      property="infoOutUrl"      jdbcType="VARCHAR"/>
    <result column="infoPostType"    property="infoPostType"    jdbcType="VARCHAR"/>
    <result column="deadlineDate"    property="deadlineDate"    jdbcType="DATE"/>
    <result column="infoArea"        property="infoArea"        jdbcType="VARCHAR"/>
    <result column="perforImg"       property="perforImg"       jdbcType="VARCHAR"/>
    <result column="infoWriteDate"   property="infoWriteDate"   jdbcType="TIMESTAMP"/>
    <result column="infoUpdateDate"  property="infoUpdateDate"  jdbcType="TIMESTAMP"/>
    <result column="infoImg"         property="infoImg"         jdbcType="VARCHAR"/>
  </resultMap>

  <!-- 목록 -->
  <select id="list" resultMap="PerforInfoMap">
    select
      infoPostNo, userNo, infoPostTitle, agencyName, infoContent, infoOutUrl,
      infoPostType, deadlineDate, infoArea, perforImg, infoWriteDate, infoUpdateDate, infoImg
    from `infoWrite`
    order by infoWriteDate desc, infoPostNo desc
  </select>

  <!-- 단건 조회 -->
  <select id="get" parameterType="long" resultMap="PerforInfoMap">
    select
      infoPostNo, userNo, infoPostTitle, agencyName, infoContent, infoOutUrl,
      infoPostType, deadlineDate, infoArea, perforImg, infoWriteDate, infoUpdateDate, infoImg
    from `infoWrite`
    where infoPostNo = #{no}
  </select>

  <!-- 글쓰기 -->
  <insert id="insert"
          parameterType="com.javaex.vo.PerforInfoVO"
          useGeneratedKeys="true"
          keyProperty="infoPostNo"
          keyColumn="infoPostNo">
    insert into `infoWrite`
      (userNo, infoPostTitle, agencyName, infoContent, infoOutUrl,
       infoPostType, deadlineDate, infoArea, perforImg, infoWriteDate, infoUpdateDate, infoImg)
    values
      (#{userNo},
       #{infoPostTitle},
       #{agencyName},
       #{infoContent},
       #{infoOutUrl},
       #{infoPostType},
       #{deadlineDate,jdbcType=DATE},
       #{infoArea},
       #{perforImg},
       now(),
       now(),
       #{infoImg})
  </insert>

</mapper>
